<html>

<head>
    <title>Is She Mad?</title>

    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script
  src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css?family=Rock+Salt" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ"
        crossorigin="anonymous">
    <link rel="stylesheet" href="styles/styles.css">
   
    
    



</head>


<body>
    <!-- <div class="navbar fixed-top bg-light" id="navbar">
        <h2 id="navTitle">Is She Mad?</h2>
        <a href="#inputDiv" class="navlinks">Form</a>
        <a href="#suggestedgift" class="navlinks">Gifts</a>
        <a href="#viewByAuthor" class="navlinks">Search By Author</a>
        <a href="#topTen" class="navlinks">Top Ten</a>
    </div> -->

    <nav class="navbar fixed-top navbar-expand-lg navbar-light bg-light" id="navbar">
            <a class="navbar-brand" id="navTitle" href="#">Is She Mad?</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
          
            <div class="collapse navbar-collapse bg-light " id="navbarSupportedContent">
              <ul class="navbar-nav  ml-auto ">
                <li class="nav-item ">
                  <a class="nav-link" id="link" href="#">Home </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link"id="link" href="#inputDiv">Form</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="link" href="#suggestedgift">Gift Suggestions</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="link" href="#viewByAuthor">Author Search</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="link" href="#topTen">Top 10</a>
                </li>
                
              </ul>
             
            </div>
          </nav>

    
         
    <div class="jumbotron jumbotron-fluid col-md-12 text-center">
       <h1 id="header-text">Is She <br>Mad?</h1>
        <div class="col-md-12 " id="topLinks">
            <ul class="list-inline">
                <li class="list-inline-item">
                    <a href="#inputDiv">Form</a>
                </li>
                <li class="list-inline-item">
                    <a href="#suggestedgift">Gifts</a>
                </li>
                <li class="list-inline-item">
                    <a href="#viewByAuthor">Author Search</a>
                </li>
                <li class="list-inline-item">
                    <a href="#topTen">Top Ten</a>
                </li>
            </ul>
            <!-- <i class="fas fa-angle-down"></i> -->


        </div>
    </div>
    </div>

    <div id="main" class="bg-light container">

        <div id="inputDiv" class="bg-light text-dark p-2 border border-light mt-5 row">
            <h1 class="inputShow col-md-12">Fill out the fields below</h1><br>
            <div class="form-group m-3 inputShow col-md-12">
                <label for="author">Author Name</label>
                <input type="text" id="authorName" name="author" class="form-control mb-3">
                <textarea name="message" id="inputText" class="form-control" cols="5" rows="4" placeholder="What did she say?"></textarea>
                <button type="submit" class="btn btn-lg bg-success mt-2 text-light" id="submit">Submit</button>
            </div>
        </div>

        <div id="suggestedgift" class ="bg-dark p-2 text-light container-fluid row p-5 mt-5">
            <div>
                <h1 class="resultsShow col-md-12">That text was
                    <span id="perc"></span>% angry!!!</h1>
                <h2 id="rank" class="text-center"></h2>
            </div>
            <div class="row text-center">
                <h1 id="giftTitle" class="">Maybe you should get her something...</h1>
                <h1 id="inputCallToAction">Fill Out the form above to see how angry she is, and we will provide suggestions for a gift!</h1>
                <div id="item-image" class="col-md-5 mt-5">
                    Image placeholder
                </div>
                <div id="gift-description" class="text-center col-md-6 mt-5">
                    <h2 class="border border-light bg-dark p-3" id="itemTitle">Fake Amazon item</h2>
                    <h2 id="desc">Bacon ipsum dolor amet meatball biltong jowl, filet mignon venison salami tenderloin tail. Buffalo cupim</h2>
                    <a id="button" href="http://google.com" class="btn-lg bg-warning text-light p-2" role="button" target="blank">Buy Now!</a>
                </div>

            </div>

        </div>
        <div id="viewByAuthor" class="bg-light row p-2 text-dark">
            <h1 class="col-md-12">View other author's results!</h1>
            <div class="form-group m-3 col-md-12">
                <label for="authorSearch">Author Name</label>
                <input type="text" id="authorSearch" name="authorSearch" class="form-control mb-3">
                <button type="submit" class="btn btn-lg bg-success mt-2 text-light" id="submitAuthor">Submit</button>
            </div>
            <div  class='row' id="authorTexts"></div>

        </div>
        <div id="topTen" class="bg-light p-2  row mt-5">
            <div class="col-md-12">
                <h1>Top Ten</h1>
            </div>

            <div id="top-ten-list" class="bg-light p-2 col-md-12 row mt-5">

            </div>


        </div>

    </div>
    </div>
    


   
    <!-- <script>

        function scrollFunction() {
            if (document.body.scrollTop > 500) {
                document.getElementById("navbar").style.top = "0";
            } else {
                document.getElementById("navbar").style.top = "-100px";
            }
        };


        $(document).on('scroll', function () {
            scrollFunction();
        });

        $(window).scroll(function () {
            if ($(document).scrollTop() < 500) {
                $('.navbar').addClass('unscrolled-bar');
            } else {
                $('.navbar').removeClass('unscrolled-bar');
            }
        });
        $(function () {
            $("#suggested-gift").hide();
            $.get("/api/topten", function (data) {
                console.log(data);
                var topTen;
                if (data.length < 10) {
                    topTen = data.length
                } else { topTen = 10 };
                for (var i = 0; i < topTen; i++) {
                    var ttdiv = $("<div class=card>");
                    var p = $("<div class=card-title>").html("#" + (i + 1));
                    var textDiv = $("<div class=card-body>").html(data[i].text);
                    var authorDiv = $("<div class=card-footer bg-light text-right class=bottom>").html(data[i].user);
                    ttdiv.append(p).append(textDiv).append(authorDiv);
                    $("#top-ten-list").append(ttdiv);
                }
            });
        })

        $('.resultsShow').hide();
        $('#rank').hide();
        $('#item-image').hide();
        $('#gift-description').hide();
        $('#giftTitle').hide();

        $('#submit').on('click', function () {
            event.preventDefault();
            console.log('clicked')
            var newTweet = {
                author: $("#authorName").val().trim(),
                text: $("#inputText").val().trim(),
            }

            $("authorName").val('');
            $("inputText").val("");

            $.post("/api/new", newTweet).then(function (result) {
                var id = result.id;


                $('.resultsShow').show();
                $('#rank').show();
                $('#item-image').show();
                $('#gift-description').show();
                $('#giftTitle').show();

                $('#inputCallToAction').hide();

                $('#perc').text(result.score);
                if (result.score < 40) {
                    $("#suggested-gift").show();
                    $("#itemTitle").html("Bouquet Of Flowers");
                    $("#desc").html("You dodged the bullet this time!! Next time you may not be so lucky. Flowers are a great way to get more brownie points in the bank for your next inevitable indiscretion!");
                    $("#item-image").html("<img src='./images/Flowers.jpg' class='gift' id='giftImg'>");
                    $("#button").attr("href", "https://www.1800flowers.com/");
                } else if (result.score >= 40 && result.score < 55) {
                    $("#suggested-gift").show();
                    $("#itemTitle").html("Chocolate");
                    $("#desc").html("Chocolate says I'm sorry so much better than words.");
                    $("#item-image").html("<img src='./images/chocolate.jpg' class='gift' id='giftImg'>");
                    $("#button").attr("href", "https://www.godiva.com/");
                } else if (result.score >= 55 && result.score < 65) {
                    $("#suggested-gift").show();
                    $("#itemTitle").html("Roses");
                    $("#desc").html("Its now time to break out the big guns. whatever you have done, you probably will want to stop doing it.");
                    $("#item-image").html("<img src='./images/roses.jpg' class='gift' id='giftImg'>");
                    $("#button").attr("href", "https://www.1800flowers.com/roses");
                } else if (result.score >= 65 && result.score < 75) {
                    $("#suggested-gift").show();
                    $("#itemTitle").html("Puppy");
                    $("#desc").html("This gift is almost unfair. Who can say no to a cute puppy, its guaranteed to melt her heart.");
                    $("#item-image").html("<img src='./images/puppy.jpg' class='gift' id='giftImg'>");
                    $("#button").attr("href", "www.aspca.org/adoptâ€Ž");
                } else if (result.score >= 75 && result.score < 85) {
                    $("#suggested-gift").show();
                    $("#itemTitle").html("Jewelry");
                    $("#desc").html("She seems like she is starting to get tired of your nonsense. Small jewelry is always a nice choice to bring you back into her good graces.");
                    $("#item-image").html("<img src='./images/jewelry.jpg' class='gift'id='giftImg'>");
                    $("#button").attr("href", "https://www.bluenile.com/jewelry?track=NavDrawJewelry");
                } else if (result.score >= 85 && result.score < 95) {
                    $("#suggested-gift").show();
                    $("#itemTitle").html("Diamonds");
                    $("#desc").html('Dude, she seems super angry. Diamonds are a "girls best friend". Always a classy choice but they can be expensive. but she deserves it for putting up with your dumb ass.');
                    $("#item-image").html("<img src='./images/diamonds.jpg' class='gift' id='giftImg'>");
                    $("#button").attr("href", "https://www.bluenile.com/diamond-jewelry");
                } else if (result.score >= 95) {
                    $("#suggested-gift").show();
                    $("#itemTitle").html("A New Car");
                    $("#desc").html('Brah, you probably do not want to go home. She is beyond pissed off. The only thing that might save you is buying her a new car.');
                    $("#item-image").html("<img src='./images/new-car.jpg' class='gift' id='giftImg'>");
                    $("#button").attr("href", "https://www.cars.com/");
                }
                $.get("/api/topten", function (data) {
                    console.log(data);
                    var rank = data.findIndex(x => x.id == id);
                    rank += 1;
                    console.log(rank);
                    $('#rank').text("It ranked #" + rank + "!");
                });
                $.get("/api/topten", function (data) {
                    console.log(data);
                    $("#top-ten-list").empty();
                    var topTen;
                    if (data.length < 10) {
                        topTen = data.length
                    } else { topTen = 10 };
                    for (var i = 0; i < topTen; i++) {
                        var TextCard='<div class="card" ><div class="card-body"><div class=card-title>#'+(i + 1)+'</div><p class="card-text">'+data[i].text+'</p> </div><div class="card-footer bg-light text-right">   '+data[i].user+'</div></div>'
                        
                        $("#top-ten-list").append(TextCard);
                    }
                });

            });

        });

        $('#submitAuthor').on('click', function () {
            //event.preventDefault();
            console.log('author query clicked')
            var authorQuery = "/api/author/" + $("#authorSearch").val().trim();
            console.log(authorQuery);

            $.get(authorQuery, function (data) {
                console.log("get request returned");
                console.log(data);
                console.log(data.length);
                $("#authorTexts").text("");
                for (var i = 0; i < data.length; i++) {
                    console.log(" it should be displaying this" + data[i].text);
                    // $("#authorTexts").append(data[i].text);
                    var authorCard='<div class="card" ><div class="card-body"><p class="card-text">'+data[i].text+'</p> </div><div class="card-footer bg-light text-right">   '+Math.floor(data[i].score)+'%</div></div>'
                    
                    
                    $("#authorTexts").append(authorCard);
                }
                $.get("/api/rank", function (data) {
                    console.log(data);

                });
            });
        }); -->

    <!-- </script> -->

</body>
<script  src='js/index.js'></script>
</html>